import{u as ge,r as I,d as me,_ as ve,e as Se,f as we,a as h,R as g,g as be,s as ce,j as x,S as _e,h as Q,T as y,t as ke,E as Te,m as Ee,i as re,W as xe,M as Ce,k as Me,b as ye,c as Re}from"./assets/workbench-cab53a1b.js";class Be{constructor(e,t,s){this._tests=new Map,this._clearPreviousResultsWhenTestBegins=!1,this._rootSuite=new z("","root"),this._pathSeparator=e,this._reporter=t,this._reportConfig=s}dispatch(e){const{method:t,params:s}=e;if(t==="onBegin"){this._onBegin(s.config,s.projects);return}if(t==="onTestBegin"){this._onTestBegin(s.testId,s.result);return}if(t==="onTestEnd"){this._onTestEnd(s.test,s.result);return}if(t==="onStepBegin"){this._onStepBegin(s.testId,s.resultId,s.step);return}if(t==="onStepEnd"){this._onStepEnd(s.testId,s.resultId,s.step);return}if(t==="onError"){this._onError(s.error);return}if(t==="onStdIO"){this._onStdIO(s.type,s.testId,s.resultId,s.data,s.isBase64);return}if(t==="onEnd")return this._onEnd(s.result);if(t==="onExit")return this._onExit()}_setClearPreviousResultsWhenTestBegins(){this._clearPreviousResultsWhenTestBegins=!0}_onBegin(e,t){var s,n;this._rootDir=e.rootDir;for(const r of t){let o=this._rootSuite.suites.find(u=>u.project().id===r.id);o||(o=new z(r.name,"project"),this._rootSuite.suites.push(o),o.parent=this._rootSuite);const d=this._parseProject(r);if(o.project=()=>d,this._mergeSuitesInto(r.suites,o),e.listOnly){const u=new Set,p=m=>{m.tests.map(f=>f.testId).forEach(f=>u.add(f)),m.suites.forEach(p)};r.suites.forEach(p);const a=m=>{m.tests=m.tests.filter(f=>u.has(f.id)),m.suites.forEach(a)};a(o)}}(n=(s=this._reporter).onBegin)==null||n.call(s,this._parseConfig(e),this._rootSuite)}_onTestBegin(e,t){var r,o;const s=this._tests.get(e);this._clearPreviousResultsWhenTestBegins&&s._clearResults();const n=s._createTestResult(t.id);n.retry=t.retry,n.workerIndex=t.workerIndex,n.parallelIndex=t.parallelIndex,n.startTime=new Date(t.startTime),n.statusEx="running",(o=(r=this._reporter).onTestBegin)==null||o.call(r,s,n)}_onTestEnd(e,t){var r,o;const s=this._tests.get(e.testId);s.timeout=e.timeout,s.expectedStatus=e.expectedStatus,s.annotations=e.annotations;const n=s.resultsMap.get(t.id);n.duration=t.duration,n.status=t.status,n.statusEx=t.status,n.errors=t.errors,n.attachments=t.attachments,(o=(r=this._reporter).onTestEnd)==null||o.call(r,s,n)}_onStepBegin(e,t,s){var u,p;const n=this._tests.get(e),r=n.resultsMap.get(t),o=s.parentStepId?r.stepMap.get(s.parentStepId):void 0,d={titlePath:()=>[],title:s.title,category:s.category,location:this._absoluteLocation(s.location),parent:o,startTime:new Date(s.startTime),duration:0,steps:[]};o&&o.steps.push(d),r.stepMap.set(s.id,d),(p=(u=this._reporter).onStepBegin)==null||p.call(u,n,r,d)}_onStepEnd(e,t,s){var d,u;const n=this._tests.get(e),r=n.resultsMap.get(t),o=r.stepMap.get(s.id);o.duration=s.duration,o.error=s.error,(u=(d=this._reporter).onStepEnd)==null||u.call(d,n,r,o)}_onError(e){var t,s;(s=(t=this._reporter).onError)==null||s.call(t,e)}_onStdIO(e,t,s,n,r){var p,a,m,f;const o=r?globalThis.Buffer?Buffer.from(n,"base64"):atob(n):n,d=t?this._tests.get(t):void 0,u=d&&s?d.resultsMap.get(s):void 0;e==="stdout"?(a=(p=this._reporter).onStdOut)==null||a.call(p,o,d,u):(f=(m=this._reporter).onStdErr)==null||f.call(m,o,d,u)}_onEnd(e){var t,s;return((s=(t=this._reporter).onEnd)==null?void 0:s.call(t,e))||void 0}_onExit(){var e,t;return(t=(e=this._reporter).onExit)==null?void 0:t.call(e)}_parseConfig(e){const t={...ue,...e};return this._reportConfig&&(t.configFile=this._reportConfig.configFile,t.reportSlowTests=this._reportConfig.reportSlowTests,t.quiet=this._reportConfig.quiet),t}_parseProject(e){return{id:e.id,metadata:e.metadata,name:e.name,outputDir:this._absolutePath(e.outputDir),repeatEach:e.repeatEach,retries:e.retries,testDir:this._absolutePath(e.testDir),testIgnore:J(e.testIgnore),testMatch:J(e.testMatch),timeout:e.timeout,grep:J(e.grep),grepInvert:J(e.grepInvert),dependencies:e.dependencies,teardown:e.teardown,snapshotDir:this._absolutePath(e.snapshotDir),use:{}}}_mergeSuitesInto(e,t){for(const s of e){let n=t.suites.find(r=>r.title===s.title);n||(n=new z(s.title,s.type),n.parent=t,t.suites.push(n)),n.location=this._absoluteLocation(s.location),n._fileId=s.fileId,n._parallelMode=s.parallelMode,this._mergeSuitesInto(s.suites,n),this._mergeTestsInto(s.tests,n)}}_mergeTestsInto(e,t){for(const s of e){let n=t.tests.find(r=>r.title===s.title);n||(n=new Ne(s.testId,s.title,this._absoluteLocation(s.location)),n.parent=t,t.tests.push(n),this._tests.set(n.id,n)),this._updateTest(s,n)}}_updateTest(e,t){return t.id=e.testId,t.location=this._absoluteLocation(e.location),t.retries=e.retries,t}_absoluteLocation(e){return e&&{...e,file:this._absolutePath(e.file)}}_absolutePath(e){return e&&this._rootDir+this._pathSeparator+e}}class z{constructor(e,t){this._requireFile="",this.suites=[],this.tests=[],this._parallelMode="default",this.title=e,this._type=t}allTests(){const e=[],t=s=>{for(const n of[...s.suites,...s.tests])n instanceof z?t(n):e.push(n)};return t(this),e}titlePath(){const e=this.parent?this.parent.titlePath():[];return(this.title||this._type!=="describe")&&e.push(this.title),e}project(){}}class Ne{constructor(e,t,s){this.fn=()=>{},this.results=[],this.expectedStatus="passed",this.timeout=0,this.annotations=[],this.retries=0,this.repeatEachIndex=0,this.resultsMap=new Map,this.id=e,this.title=t,this.location=s}titlePath(){const e=this.parent?this.parent.titlePath():[];return e.push(this.title),e}outcome(){const e=this.results.filter(t=>t.status!=="skipped"&&t.status!=="interrupted");return e.length?e.every(t=>t.status===this.expectedStatus)?"expected":e.some(t=>t.status===this.expectedStatus)?"flaky":"unexpected":"skipped"}ok(){const e=this.outcome();return e==="expected"||e==="flaky"||e==="skipped"}_clearResults(){this.results=[],this.resultsMap.clear()}_createTestResult(e){const t={retry:this.results.length,parallelIndex:-1,workerIndex:-1,duration:-1,startTime:new Date,stdout:[],stderr:[],attachments:[],status:"skipped",statusEx:"scheduled",steps:[],errors:[],stepMap:new Map};return this.results.push(t),this.resultsMap.set(e,t),t}}const ue={forbidOnly:!1,fullyParallel:!1,globalSetup:null,globalTeardown:null,globalTimeout:0,grep:/.*/,grepInvert:null,maxFailures:0,metadata:{},preserveOutput:"always",projects:[],reporter:[[{}.CI?"dot":"list"]],reportSlowTests:{max:5,threshold:15e3},configFile:"",rootDir:"",quiet:!1,shard:null,updateSnapshots:"missing",version:"",workers:0,webServer:null};function J(i){return i.map(e=>e.s?e.s:new RegExp(e.r.source,e.r.flags))}const Le=({source:i})=>{const[e,t]=ge(),[s,n]=I.useState(me()),[r]=I.useState(ve(()=>import("./assets/xtermModule-443332e6.js"),["./assets/xtermModule-443332e6.js","./xtermModule.6428296b.css"],import.meta.url).then(d=>d.default)),o=I.useRef(null);return I.useEffect(()=>(Se(n),()=>we(n)),[]),I.useEffect(()=>{const d=i.write,u=i.clear;return(async()=>{const{Terminal:p,FitAddon:a}=await r,m=t.current;if(!m)return;const f=s==="dark-mode"?De:Fe;if(o.current&&o.current.terminal.options.theme===f)return;o.current&&(m.textContent="");const c=new p({convertEol:!0,fontSize:13,scrollback:1e4,fontFamily:"var(--vscode-editor-font-family)",theme:f}),v=new a;c.loadAddon(v);for(const w of i.pending)c.write(w);i.write=w=>{i.pending.push(w),c.write(w)},i.clear=()=>{i.pending=[],c.clear()},c.open(m),v.fit(),o.current={terminal:c,fitAddon:v}})(),()=>{i.clear=u,i.write=d}},[r,o,t,i,s]),I.useEffect(()=>{setTimeout(()=>{o.current&&(o.current.fitAddon.fit(),i.resize(o.current.terminal.cols,o.current.terminal.rows))},250)},[e,i]),h("div",{"data-testid":"output",className:"xterm-wrapper",style:{flex:"auto"},ref:t})},Fe={foreground:"#383a42",background:"#fafafa",cursor:"#383a42",black:"#000000",red:"#e45649",green:"#50a14f",yellow:"#c18401",blue:"#4078f2",magenta:"#a626a4",cyan:"#0184bc",white:"#a0a0a0",brightBlack:"#000000",brightRed:"#e06c75",brightGreen:"#98c379",brightYellow:"#d19a66",brightBlue:"#4078f2",brightMagenta:"#a626a4",brightCyan:"#0184bc",brightWhite:"#383a42",selectionBackground:"#d7d7d7",selectionForeground:"#383a42"},De={foreground:"#f8f8f2",background:"#1e1e1e",cursor:"#f8f8f0",black:"#000000",red:"#ff5555",green:"#50fa7b",yellow:"#f1fa8c",blue:"#bd93f9",magenta:"#ff79c6",cyan:"#8be9fd",white:"#bfbfbf",brightBlack:"#4d4d4d",brightRed:"#ff6e6e",brightGreen:"#69ff94",brightYellow:"#ffffa5",brightBlue:"#d6acff",brightMagenta:"#ff92df",brightCyan:"#a4ffff",brightWhite:"#e6e6e6",selectionBackground:"#44475a",selectionForeground:"#f8f8f2"};function Pe(i){return`.playwright-artifacts-${i}`}let ie=()=>{},de=i=>{},fe={cols:80,rows:24};const P={pending:[],clear:()=>{},write:i=>P.pending.push(i),resize:(i,e)=>{fe={cols:i,rows:e},H("resizeTerminal",{cols:i,rows:e})}},We=({})=>{var oe;const[i,e]=g.useState(""),[t,s]=g.useState(!1),[n,r]=g.useState(new Map([["passed",!1],["failed",!1],["skipped",!1]])),[o,d]=g.useState(new Map),[u,p]=g.useState({config:void 0,rootSuite:void 0,loadErrors:[]}),[a,m]=g.useState(),[f,c]=g.useState({}),[v,w]=g.useState(new Set),[k,M]=g.useState(!1),[C,B]=g.useState(),[R,Y]=be("watch-all",!1),[te,A]=g.useState({value:new Set}),l=g.useRef(Promise.resolve()),_=g.useRef(new Set),[S,b]=g.useState(0),T=g.useRef(null),E=g.useCallback(()=>{M(!0),A({value:new Set}),ie(ue,new z("","root"),[],void 0),he(!0).then(()=>{M(!1)})},[]);g.useEffect(()=>{var L;(L=T.current)==null||L.focus(),E()},[E]),ie=g.useCallback((L,K,F,O)=>{const D=L.configFile?ce.getObject(L.configFile+":projects",void 0):void 0;for(const N of o.keys())K.suites.find(X=>X.title===N)||o.delete(N);for(const N of K.suites)o.has(N.title)||o.set(N.title,!!(D!=null&&D.includes(N.title)));!D&&o.size&&![...o.values()].includes(!0)&&o.set(o.entries().next().value[0],!0),p({config:L,rootSuite:K,loadErrors:F}),d(new Map(o)),C&&O?m({...O,total:C.testIds.size}):O||m(void 0)},[o,C]);const V=g.useCallback((L,K)=>{L==="bounce-if-busy"&&C||(_.current=new Set([..._.current,...K]),l.current=l.current.then(async()=>{var D,N,X;const F=_.current;if(_.current=new Set,!F.size)return;{for(const j of((D=u.rootSuite)==null?void 0:D.allTests())||[])F.has(j.id)&&(j._clearResults(),j._createTestResult("pending"));p({...u})}const O="  ["+new Date().toLocaleTimeString()+"]";P.write("\x1B[2m—".repeat(Math.max(0,fe.cols-O.length))+O+"\x1B[22m"),m({total:F.size,passed:0,failed:0,skipped:0}),B({testIds:F}),await G("run",{testIds:[...F]});for(const j of((N=u.rootSuite)==null?void 0:N.allTests())||[])((X=j.results[0])==null?void 0:X.duration)===-1&&j._clearResults();p({...u}),B(void 0)}))},[C,u]),W=!!C;return h("div",{className:"vbox ui-mode",children:x(_e,{sidebarSize:250,orientation:"horizontal",sidebarIsFirst:!0,children:[x("div",{className:"vbox",children:[x("div",{className:"vbox"+(t?"":" hidden"),children:[x(Q,{children:[h("div",{className:"section-title",style:{flex:"none"},children:"Output"}),h(y,{icon:"circle-slash",title:"Clear output",onClick:()=>P.clear()}),h("div",{className:"spacer"}),h(y,{icon:"close",title:"Close",onClick:()=>s(!1)})]}),h(Le,{source:P})]}),h("div",{className:"vbox"+(t?" hidden":""),children:h(ze,{item:f,rootDir:(oe=u.config)==null?void 0:oe.rootDir})})]}),x("div",{className:"vbox ui-mode-sidebar",children:[x(Q,{noShadow:!0,noMinHeight:!0,children:[h("img",{src:"icon-32x32.png"}),h("div",{className:"section-title",children:"Playwright"}),h(y,{icon:"color-mode",title:"Toggle color mode",onClick:()=>ke()}),h(y,{icon:"refresh",title:"Reload",onClick:()=>E(),disabled:W||k}),h(y,{icon:"terminal",title:"Toggle output",toggled:t,onClick:()=>{s(!t)}})]}),h(Oe,{filterText:i,setFilterText:e,statusFilters:n,setStatusFilters:r,projectFilters:o,setProjectFilters:d,testModel:u,runTests:()=>V("bounce-if-busy",v)}),x(Q,{noMinHeight:!0,children:[!W&&!a&&h("div",{className:"section-title",children:"Tests"}),!W&&a&&h("div",{"data-testid":"status-line",className:"status-line",children:x("div",{children:[a.passed,"/",a.total," passed (",a.passed/a.total*100|0,"%)"]})}),W&&a&&h("div",{"data-testid":"status-line",className:"status-line",children:x("div",{children:["Running ",a.passed,"/",C.testIds.size," passed (",a.passed/C.testIds.size*100|0,"%)"]})}),h(y,{icon:"play",title:"Run all",onClick:()=>V("bounce-if-busy",v),disabled:W||k}),h(y,{icon:"debug-stop",title:"Stop",onClick:()=>H("stop"),disabled:!W||k}),h(y,{icon:"eye",title:"Watch all",toggled:R,onClick:()=>Y(!R)}),h(y,{icon:"collapse-all",title:"Collapse all",onClick:()=>{b(S+1)}})]}),h(Ie,{statusFilters:n,projectFilters:o,filterText:i,testModel:u,runningState:C,runTests:V,onItemSelected:c,setVisibleTestIds:w,watchAll:R,watchedTreeIds:te,setWatchedTreeIds:A,isLoading:k,requestedCollapseAllCount:S})]})]})})},Oe=({filterText:i,setFilterText:e,statusFilters:t,setStatusFilters:s,projectFilters:n,setProjectFilters:r,testModel:o,runTests:d})=>{const[u,p]=g.useState(!1),a=g.useRef(null);g.useEffect(()=>{var c;(c=a.current)==null||c.focus()},[]);const m=[...t.entries()].filter(([c,v])=>v).map(([c])=>c).join(" ")||"all",f=[...n.entries()].filter(([c,v])=>v).map(([c])=>c).join(" ")||"all";return x("div",{className:"filters",children:[h(Te,{expanded:u,setExpanded:p,title:h("input",{ref:a,type:"search",placeholder:"Filter (e.g. text, @tag)",spellCheck:!1,value:i,onChange:c=>{e(c.target.value)},onKeyDown:c=>{c.key==="Enter"&&d()}})}),x("div",{className:"filter-summary",title:"Status: "+m+`
Projects: `+f,onClick:()=>p(!u),children:[h("span",{className:"filter-label",children:"Status:"})," ",m,h("span",{className:"filter-label",children:"Projects:"})," ",f]}),u&&x("div",{className:"hbox",style:{marginLeft:14},children:[h("div",{className:"filter-list",children:[...t.entries()].map(([c,v])=>h("div",{className:"filter-entry",children:x("label",{children:[h("input",{type:"checkbox",checked:v,onClick:()=>{const w=new Map(t);w.set(c,!w.get(c)),s(w)}}),h("div",{children:c})]})}))}),h("div",{className:"filter-list",children:[...n.entries()].map(([c,v])=>h("div",{className:"filter-entry",children:x("label",{children:[h("input",{type:"checkbox",checked:v,onClick:()=>{var M;const w=new Map(n);w.set(c,!w.get(c)),r(w);const k=(M=o==null?void 0:o.config)==null?void 0:M.configFile;k&&ce.setObject(k+":projects",[...w.entries()].filter(([C,B])=>B).map(([C])=>C))}}),h("div",{children:c})]})}))})]})]})},je=Me,Ie=({statusFilters:i,projectFilters:e,filterText:t,testModel:s,runTests:n,runningState:r,watchAll:o,watchedTreeIds:d,setWatchedTreeIds:u,isLoading:p,onItemSelected:a,setVisibleTestIds:m,requestedCollapseAllCount:f})=>{const[c,v]=g.useState({expandedItems:new Map}),[w,k]=g.useState(),[M,C]=g.useState(f),{rootItem:B,treeItemMap:R,fileNames:Y}=g.useMemo(()=>{let l=Ke(s.rootSuite,s.loadErrors,e);Ue(l,t,i,r==null?void 0:r.testIds),pe(l),l=$e(l),qe(l);const _=new Map,S=new Set,b=new Set,T=E=>{E.kind==="group"&&E.location.file&&b.add(E.location.file),E.kind==="case"&&E.tests.forEach(V=>S.add(V.id)),E.children.forEach(T),_.set(E.id,E)};return T(l),m(S),{rootItem:l,treeItemMap:_,fileNames:b}},[t,s,i,e,m,r]);g.useEffect(()=>{if(M!==f){c.expandedItems.clear();for(const S of R.keys())c.expandedItems.set(S,!1);C(f),k(void 0),v({...c});return}if(!r||r.itemSelectedByUser)return;let l;const _=S=>{var b;S.children.forEach(_),!l&&S.status==="failed"&&(S.kind==="test"&&r.testIds.has(S.test.id)||S.kind==="case"&&r.testIds.has((b=S.tests[0])==null?void 0:b.id))&&(l=S)};_(B),l&&k(l.id)},[r,k,B,M,C,f,c,v,R]);const{selectedTreeItem:te}=g.useMemo(()=>{const l=w?R.get(w):void 0;let _;l&&(_={file:l.location.file,line:l.location.line,source:{errors:s.loadErrors.filter(b=>{var T;return((T=b.location)==null?void 0:T.file)===l.location.file}).map(b=>({line:b.location.line,message:b.message})),content:void 0}});let S;return(l==null?void 0:l.kind)==="test"?S=l.test:(l==null?void 0:l.kind)==="case"&&l.tests.length===1&&(S=l.tests[0]),a({testCase:S,testFile:_}),{selectedTreeItem:l}},[a,w,s,R]);g.useEffect(()=>{if(o)H("watch",{fileNames:[...Y]});else{const l=new Set;for(const _ of d.value){const S=R.get(_),b=S==null?void 0:S.location.file;b&&l.add(b)}H("watch",{fileNames:[...l]})}},[B,Y,o,d,R]);const A=l=>{k(l.id),n("bounce-if-busy",se(l))};return de=l=>{const _=[],S=new Set(l);if(o){const b=T=>{const E=T.location.file;E&&S.has(E)&&_.push(...se(T)),T.kind==="group"&&T.subKind==="folder"&&T.children.forEach(b)};b(B)}else for(const b of d.value){const T=R.get(b),E=T==null?void 0:T.location.file;E&&S.has(E)&&_.push(...se(T))}n("queue-if-busy",new Set(_))},h(je,{treeState:c,setTreeState:v,rootItem:B,dataTestId:"test-tree",render:l=>x("div",{className:"hbox ui-mode-list-item",children:[h("div",{className:"ui-mode-list-item-title",children:l.title}),!!l.duration&&l.status!=="skipped"&&h("div",{className:"ui-mode-list-item-time",children:Ee(l.duration)}),x(Q,{noMinHeight:!0,noShadow:!0,children:[h(y,{icon:"play",title:"Run",onClick:()=>A(l),disabled:!!r}),h(y,{icon:"go-to-file",title:"Open in VS Code",onClick:()=>H("open",{location:Ve(l)})}),!o&&h(y,{icon:"eye",title:"Watch",onClick:()=>{d.value.has(l.id)?d.value.delete(l.id):d.value.add(l.id),u({...d})},toggled:d.value.has(l.id)})]})]}),icon:l=>l.status==="scheduled"?"codicon-clock":l.status==="running"?"codicon-loading":l.status==="failed"?"codicon-error":l.status==="passed"?"codicon-check":l.status==="skipped"?"codicon-circle-slash":"codicon-circle-outline",selectedItem:te,onAccepted:A,onSelected:l=>{r&&(r.itemSelectedByUser=!0),k(l.id)},isError:l=>l.kind==="group"?l.hasLoadErrors:!1,autoExpandDepth:t?5:1,noItemsMessage:p?"Loading…":"No tests"})},ze=({item:i,rootDir:e})=>{const[t,s]=g.useState(),[n,r]=g.useState(0),o=g.useRef(null),{outputDir:d}=g.useMemo(()=>({outputDir:i.testCase?Ae(i.testCase):void 0}),[i]),[u,p]=g.useState(),a=g.useCallback(f=>p(re(f)),[p]),m=u?t==null?void 0:t.model.actions.find(f=>re(f)===u):void 0;return g.useEffect(()=>{var w,k;o.current&&clearTimeout(o.current);const f=(w=i.testCase)==null?void 0:w.results[0];if(!f){s(void 0);return}const c=f&&f.duration>=0&&f.attachments.find(M=>M.name==="trace");if(c&&c.path){ae(c.path).then(M=>s({model:M,isLive:!1}));return}if(!d){s(void 0);return}const v=`${d}/${Pe(f.workerIndex)}/traces/${(k=i.testCase)==null?void 0:k.id}.json`;return o.current=setTimeout(async()=>{try{const M=await ae(v);s({model:M,isLive:!0})}catch{s(void 0)}finally{r(n+1)}},500),()=>{o.current&&clearTimeout(o.current)}},[d,i,s,n,r]),h(xe,{model:t==null?void 0:t.model,hideTimelineBars:!0,hideStackFrames:!0,showSourcesFirst:!0,rootDir:e,initialSelection:m,onSelectionChanged:a,fallbackLocation:i.testFile,isLive:t==null?void 0:t.isLive},"workbench")};let q,Z,$;const le=()=>{clearTimeout(Z),Z=void 0,ie($.config,$.rootSuite,$.loadErrors,$.progress)},U=(i,e,t,s,n=!1)=>{$={config:i,rootSuite:e,loadErrors:t,progress:s},n?le():Z||(Z=setTimeout(le,250))},he=i=>{if(!i)return G("list",{});let e,t;const s={passed:0,failed:0,skipped:0};let n;return q=new Be(ee,{onBegin:(r,o)=>{e||(e=o,t=[]),n=r,s.passed=0,s.failed=0,s.skipped=0,U(n,e,t,s,!0)},onEnd:()=>{U(n,e,t,s,!0)},onTestBegin:()=>{U(n,e,t,s)},onTestEnd:r=>{r.outcome()==="skipped"?++s.skipped:r.outcome()==="unexpected"?++s.failed:++s.passed,U(n,e,t,s)},onError:r=>{P.write((r.stack||r.value||"")+`
`),t.push(r),U(n,e,t,s)}}),q._setClearPreviousResultsWhenTestBegins(),G("list",{})};window.dispatch=i=>{var e;if(i.method==="listChanged"){he(!1).catch(()=>{});return}if(i.method==="testFilesChanged"){de(i.params.testFileNames);return}if(i.method==="stdio"){if(i.params.buffer){const t=atob(i.params.buffer);P.write(t)}else P.write(i.params.text);return}(e=q==null?void 0:q.dispatch(i))==null||e.catch(()=>{})};const G=async(i,e)=>{await window.sendMessage({method:i,params:e})},H=(i,e)=>{if(window._overrideProtocolForTest){window._overrideProtocolForTest({method:i,params:e}).catch(()=>{});return}G(i,e).catch(t=>{console.error(t)})},Ae=i=>{var e;for(let t=i.parent;t;t=t.parent)if(t.project())return(e=t.project())==null?void 0:e.outputDir},Ve=i=>{if(i)return i.location.file+":"+i.location.line},se=i=>{const e=new Set;if(!i)return e;const t=s=>{var n;s.kind==="case"?s.tests.map(r=>r.id).forEach(r=>e.add(r)):s.kind==="test"?e.add(s.id):(n=s.children)==null||n.forEach(t)};return t(i),e};function ne(i,e,t,s){if(e.length===0)return i;const n=e.join(ee),r=s.get(n);if(r)return r;const o=ne(i,e.slice(0,e.length-1),!1,s),d={kind:"group",subKind:t?"file":"folder",id:n,title:e[e.length-1],location:{file:n,line:0,column:0},duration:0,parent:o,children:[],status:"none",hasLoadErrors:!1};return o.children.push(d),s.set(n,d),d}function Ke(i,e,t){const s=[...t.values()].some(Boolean),n={kind:"group",subKind:"folder",id:"root",title:"",location:{file:"",line:0,column:0},duration:0,parent:void 0,children:[],status:"none",hasLoadErrors:!1},r=(d,u,p)=>{for(const a of u.suites){const m=a.title||"<anonymous>";let f=p.children.find(c=>c.title===m);f||(f={kind:"group",subKind:"describe",id:p.id+""+m,title:m,location:a.location,duration:0,parent:p,children:[],status:"none",hasLoadErrors:!1},p.children.push(f)),r(d,a,f)}for(const a of u.tests){const m=a.title;let f=p.children.find(w=>w.title===m);f||(f={kind:"case",id:p.id+""+m,title:m,parent:p,children:[],tests:[],location:a.location,duration:0,status:"none"},p.children.push(f));const c=a.results[0];let v="none";(c==null?void 0:c.statusEx)==="scheduled"?v="scheduled":(c==null?void 0:c.statusEx)==="running"?v="running":(c==null?void 0:c.status)==="skipped"?v="skipped":(c==null?void 0:c.status)==="interrupted"?v="none":c&&a.outcome()!=="expected"?v="failed":c&&a.outcome()==="expected"&&(v="passed"),f.tests.push(a),f.children.push({kind:"test",id:a.id,title:d,location:a.location,test:a,parent:f,children:[],status:v,duration:a.results.length?Math.max(0,a.results[0].duration):0,project:d}),f.duration=f.children.reduce((w,k)=>w+k.duration,0)}},o=new Map;for(const d of(i==null?void 0:i.suites)||[])if(!(s&&!t.get(d.title))){for(const u of d.suites){const p=ne(n,u.location.file.split(ee),!0,o);r(d.title,u,p)}for(const u of e){if(!u.location)continue;const p=ne(n,u.location.file.split(ee),!0,o);p.hasLoadErrors=!0}}return n}function Ue(i,e,t,s){const n=e.trim().toLowerCase().split(" "),r=[...t.values()].some(Boolean),o=u=>{const p=u.tests[0].titlePath().join(" ").toLowerCase();return!n.every(a=>p.includes(a))&&!u.tests.some(a=>s==null?void 0:s.has(a.id))?!1:(u.children=u.children.filter(a=>!r||(s==null?void 0:s.has(a.id))||t.get(a.status)),u.tests=u.children.map(a=>a.test),!!u.children.length)},d=u=>{const p=[];for(const a of u.children)a.kind==="case"?o(a)&&p.push(a):(d(a),(a.children.length||a.hasLoadErrors)&&p.push(a));u.children=p};d(i)}function pe(i){for(const o of i.children)pe(o);i.kind==="group"&&i.children.sort((o,d)=>o.location.file.localeCompare(d.location.file)||o.location.line-d.location.line);let e=i.children.length>0,t=i.children.length>0,s=!1,n=!1,r=!1;for(const o of i.children)t=t&&o.status==="skipped",e=e&&(o.status==="passed"||o.status==="skipped"),s=s||o.status==="failed",n=n||o.status==="running",r=r||o.status==="scheduled";n?i.status="running":r?i.status="scheduled":s?i.status="failed":t?i.status="skipped":e&&(i.status="passed")}function $e(i){let e=i;for(;e.children.length===1&&e.children[0].kind==="group"&&e.children[0].subKind==="folder";)e=e.children[0];return e.location=i.location,e}function qe(i){const e=t=>{t.kind==="case"&&t.children.length===1?t.children=[]:t.children.forEach(e)};e(i)}async function ae(i){const e=new URLSearchParams;e.set("trace",i);const s=await(await fetch(`contexts?${e.toString()}`)).json();return new Ce(s)}const ee=navigator.userAgent.toLowerCase().includes("windows")?"\\":"/";(async()=>(ye(),window.location.protocol!=="file:"&&(window.location.href.includes("isUnderTest=true")&&await new Promise(i=>setTimeout(i,1e3)),navigator.serviceWorker.register("sw.bundle.js"),navigator.serviceWorker.controller||await new Promise(i=>{navigator.serviceWorker.oncontrollerchange=()=>i()}),setInterval(function(){fetch("ping")},1e4)),Re.render(h(We,{}),document.querySelector("#root"))))();
